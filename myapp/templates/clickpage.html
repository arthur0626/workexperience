<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ facility.facility_name }} - ëŒë´„ ë‚˜ì¹¨ë°˜</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Malgun Gothic', sans-serif; background-color: #f8f9fa; color: #333; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .header { display: flex; justify-content: space-between; align-items: center; padding: 20px 0; border-bottom: 1px solid #e9ecef; background: white; margin-bottom: 30px; }
        .logo { display: flex; align-items: center; font-size: 24px; font-weight: bold; color: #7c3aed; text-decoration: none; }
        .nav-buttons { display: flex; gap: 10px; }
        .btn { padding: 10px 20px; border: none; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: bold; transition: all 0.3s; text-decoration: none; display: inline-block; }
        .btn-secondary { background: white; color: #7c3aed; border: 2px solid #7c3aed; }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(124, 58, 237, 0.3); }
        .back-button { background: none; border: none; font-size: 16px; cursor: pointer; color: #7c3aed; margin-bottom: 20px; display: inline-block; }
        .facility-detail { display: grid; grid-template-columns: 1fr 350px; gap: 30px; }
        .main-content, .sidebar { display: flex; flex-direction: column; gap: 30px; }
        .card { background: white; border-radius: 12px; padding: 30px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .card-title { font-size: 20px; font-weight: bold; color: #333; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px solid #eee; }
        .facility-title { font-size: 28px; font-weight: bold; color: #333; margin-bottom: 8px; }
        .facility-subtitle { font-size: 16px; color: #666; margin-bottom: 20px; }
        .description { line-height: 1.7; color: #555; }
        .info-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px 25px; }
        .info-item { display: flex; align-items: baseline; }
        .info-label { font-weight: bold; color: #333; width: 140px; flex-shrink: 0; }
        .info-value { color: #555; }
        .info-value a { color: #7c3aed; text-decoration: none; }
        .info-value a:hover { text-decoration: underline; }
        .capacity-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; text-align: center; }
        .capacity-item { background: #f8f9fa; padding: 15px; border-radius: 8px; }
        .capacity-label { font-size: 14px; color: #666; margin-bottom: 5px; }
        .capacity-value { font-size: 20px; font-weight: bold; color: #7c3aed; }
        
        @media (max-width: 992px) { .facility-detail { grid-template-columns: 1fr; } .sidebar { order: -1; } }
        @media (max-width: 576px) { .info-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <div class="header">
        <div class="container">
            <div style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
                <a href="{% url 'main' %}" class="logo">ğŸ§­ ëŒë´„ ë‚˜ì¹¨ë°˜</a>
                <div class="nav-buttons">
                    {% if user.is_authenticated %}
                        <a href="{% url 'mypage' %}" class="btn btn-secondary">ë§ˆì´í˜ì´ì§€</a>
                        <a href="{% url 'kakao_logout' %}" class="btn btn-secondary">ë¡œê·¸ì•„ì›ƒ</a>
                    {% else %}
                        <a href="{% url 'kakao_login' %}" class="btn btn-secondary">ì¹´ì¹´ì˜¤í†¡ìœ¼ë¡œ ë¡œê·¸ì¸</a>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    
    <div class="container">
        <a href="javascript:history.back()" class="back-button">â† ë’¤ë¡œê°€ê¸°</a>
        
        <div class="facility-detail">
            <div class="main-content">
                <div class="card">
                    <p class="facility-subtitle">{{ facility.institution_type|default:"ì •ë³´ ì—†ìŒ" }}</p>
                    <h1 class="facility-title">{{ facility.facility_name }}</h1>
                    <div class="info-grid" style="grid-template-columns: 1fr; margin-top: 20px;">
                        <div class="info-item">
                            <span class="info-label">ğŸ“ ì „í™”ë²ˆí˜¸</span>
                            <span class="info-value">{{ facility.phone_number|default:"-" }}</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">ğŸ  í™ˆí˜ì´ì§€</span>
                            <span class="info-value">
                                {% if facility.homepage and facility.homepage != '-' %}
                                    <a href="{{ facility.homepage }}" target="_blank">{{ facility.homepage }}</a>
                                {% else %}
                                    -
                                {% endif %}
                            </span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">ğŸ“ ì£¼ì†Œ</span>
                            <span class="info-value">{{ facility.address|default:"-" }}</span>
                        </div>
                         <div class="info-item">
                            <span class="info-label">ğŸ“… ì§€ì •ì¼</span>
                            <span class="info-value">{{ facility.designation_date|default:"-" }}</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">ğŸš— ì£¼ì°¨ì‹œì„¤</span>
                            <span class="info-value">{{ facility.parking_facility|default:"-" }}</span>
                        </div>
                    </div>
                </div>
                {% comment %} templates/facility_detail.html ìˆ˜ì • {% endcomment %}

<div class="card">
    <h3 class="card-title">ìœ„ì¹˜</h3>
    <div class="location-info">
        <div class="address" style="display: flex; align-items: flex-start; gap: 10px; font-size: 16px; margin-bottom: 20px;">
            <span style="color: #2c5aa0;">ğŸ“</span>
            <span>{{ facility.address|default:"ì£¼ì†Œ ì •ë³´ ì—†ìŒ" }}</span>
        </div>

        {% comment %} --- ì§€ë„ í‘œì‹œ ì˜ì—­ ìˆ˜ì • --- {% endcomment %}
        {% if map_url %}
            <div class="map-container" style="width:100%; height:300px; border-radius:10px; overflow:hidden; border: 1px solid #eee;">
                <iframe
                    src="{{ map_url }}"
                    width="100%"
                    height="100%"
                    style="border:0;"
                    allowfullscreen=""
                    loading="lazy"
                    referrerpolicy="no-referrer-when-downgrade">
                </iframe>
            </div>
        {% else %}
            <div class="map-container" style="width:100%; height:200px; border-radius:10px; background-color: #f0f0f0; display:flex; align-items:center; justify-content:center; color:#888;">
                ì£¼ì†Œ ì •ë³´ê°€ ì—†ì–´ ì§€ë„ë¥¼ í‘œì‹œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
            </div>
        {% endif %}
    </div>
</div>

                <div class="card">
                    <h3 class="card-title">êµí†µí¸ ì •ë³´</h3>
                    <div class="description">
                        <p>{{ facility.transportation|default:"êµí†µí¸ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤."|linebreaksbr }}</p>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">ì§ì› í˜„í™©</h3>
                    <div class="info-grid">
                        {% if facility.head_of_facility and facility.head_of_facility != '0' %}<div class="info-item"><span class="info-label">ì‹œì„¤ì¥</span><span class="info-value">{{ facility.head_of_facility }}</span></div>{% endif %}
                        {% if facility.general_manager and facility.general_manager != '0' %}<div class="info-item"><span class="info-label">ì‚¬ë¬´êµ­ì¥</span><span class="info-value">{{ facility.general_manager }}</span></div>{% endif %}
                        {% if facility.social_worker and facility.social_worker != '0' %}<div class="info-item"><span class="info-label">ì‚¬íšŒë³µì§€ì‚¬</span><span class="info-value">{{ facility.social_worker }}</span></div>{% endif %}
                        {% if facility.nurse and facility.nurse != '0' %}<div class="info-item"><span class="info-label">ê°„í˜¸ì‚¬</span><span class="info-value">{{ facility.nurse }}</span></div>{% endif %}
                        {% if facility.nursing_assistant and facility.nursing_assistant != '0' %}<div class="info-item"><span class="info-label">ê°„í˜¸ì¡°ë¬´ì‚¬</span><span class="info-value">{{ facility.nursing_assistant }}</span></div>{% endif %}
                        {% if facility.physical_therapist and facility.physical_therapist != '0' %}<div class="info-item"><span class="info-label">ë¬¼ë¦¬ì¹˜ë£Œì‚¬</span><span class="info-value">{{ facility.physical_therapist }}</span></div>{% endif %}
                        {% if facility.occupational_therapist and facility.occupational_therapist != '0' %}<div class="info-item"><span class="info-label">ì‘ì—…ì¹˜ë£Œì‚¬</span><span class="info-value">{{ facility.occupational_therapist }}</span></div>{% endif %}
                        {% if facility.nutritionist and facility.nutritionist != '0' %}<div class="info-item"><span class="info-label">ì˜ì–‘ì‚¬</span><span class="info-value">{{ facility.nutritionist }}</span></div>{% endif %}
                        {% if facility.cook and facility.cook != '0' %}<div class="info-item"><span class="info-label">ì¡°ë¦¬ì›</span><span class="info-value">{{ facility.cook }}</span></div>{% endif %}
                        {% if facility.sanitation_worker and facility.sanitation_worker != '0' %}<div class="info-item"><span class="info-label">ìœ„ìƒì›</span><span class="info-value">{{ facility.sanitation_worker }}</span></div>{% endif %}
                        {% if facility.office_worker and facility.office_worker != '0' %}<div class="info-item"><span class="info-label">ì‚¬ë¬´ì›</span><span class="info-value">{{ facility.office_worker }}</span></div>{% endif %}
                        {% if facility.manager and facility.manager != '0' %}<div class="info-item"><span class="info-label">ê´€ë¦¬ì¸</span><span class="info-value">{{ facility.manager }}</span></div>{% endif %}
                        {% if facility.assistant and facility.assistant != '0' %}<div class="info-item"><span class="info-label">ë³´ì¡°ì›</span><span class="info-value">{{ facility.assistant }}</span></div>{% endif %}
                        {% if facility.contract and facility.contract != '0' %}<div class="info-item"><span class="info-label">ê³„ì•½ì˜ì‚¬</span><span class="info-value">{{ facility.contract }}</span></div>{% endif %}
                        {% if facility.suspended and facility.suspended != '0' %}<div class="info-item"><span class="info-label">ìœ ì˜ˆì¸ë ¥</span><span class="info-value">{{ facility.suspended }}</span></div>{% endif %}
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">ìš”ì–‘ë³´í˜¸ì‚¬ í˜„í™©</h3>
                    <div class="info-grid">
                        <div class="info-item"><span class="info-label">ì¬ê°€ë…¸ì¸-1ê¸‰</span><span class="info-value">{{ facility.caregiver_type1|default:'0' }}</span></div>
                        <div class="info-item"><span class="info-label">ì¬ê°€ë…¸ì¸-2ê¸‰</span><span class="info-value">{{ facility.caregiver_type2|default:'0' }}</span></div>
                        <div class="info-item"><span class="info-label">ì¬ê°€ë…¸ì¸-ìœ ì˜ˆ</span><span class="info-value">{{ facility.caregiver_suspended|default:'0' }}</span></div>
                        <div class="info-item"><span class="info-label">ì¬ê°€ì¥ê¸°-1ê¸‰</span><span class="info-value">{{ facility.longterm_caregiver_type1|default:'0' }}</span></div>
                        <div class="info-item"><span class="info-label">ì¬ê°€ì¥ê¸°-2ê¸‰</span><span class="info-value">{{ facility.longterm_caregiver_type2|default:'0' }}</span></div>
                        <div class="info-item"><span class="info-label">ì¬ê°€ì¥ê¸°-ìœ ì˜ˆ</span><span class="info-value">{{ facility.longterm_caregiver_suspended|default:'0' }}</span></div>
                    </div>
                </div>
            </div>
            
            <div class="sidebar">
                <div class="card">
                    <h3 class="card-title">ì •ì› ë° í˜„í™©</h3>
                    <div class="capacity-item" style="margin-bottom: 20px;">
                        <div class="capacity-label">ì „ì²´ ì •ì›</div>
                        <div class="capacity-value">{{ facility.capacity|default:'-' }}ëª…</div>
                    </div>
                    <div class="capacity-grid">
                        <div class="capacity-item">
                            <div class="capacity-label">í˜„ì¬ ì¸ì›</div>
                            <div class="capacity-value">ë‚¨ {{ facility.current_male|default:'0' }} / ì—¬ {{ facility.current_female|default:'0' }}</div>
                        </div>
                        <div class="capacity-item">
                            <div class="capacity-label">ëŒ€ê¸° ì¸ì›</div>
                            <div class="capacity-value">ë‚¨ {{ facility.waiting_male|default:'0' }} / ì—¬ {{ facility.waiting_female|default:'0' }}</div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">ì‹œì„¤ ë‚´ë¶€ ì •ë³´</h3>
                    <div class="info-grid" style="grid-template-columns: 1fr;">
                        <div class="info-item"><span class="info-label">ì‚¬ë¬´ì‹¤</span><span class="info-value">{{ facility.office|default:'-' }}</span></div>
                        <div class="info-item"><span class="info-label">ì¹¨ì‹¤</span><span class="info-value">{{ facility.bedroom|default:'-' }}</span></div>
                        <div class="info-item"><span class="info-label">í™”ì¥ì‹¤</span><span class="info-value">{{ facility.toilet|default:'-' }}</span></div>
                        <div class="info-item"><span class="info-label">ì„¸ë©´/ì„¸íƒì‹¤</span><span class="info-value">{{ facility.washing_room|default:'-' }}</span></div>
                        <div class="info-item"><span class="info-label">ì£¼ì•¼ê°„ë³´í˜¸</span><span class="info-value">{{ facility.day_night_care|default:'-' }}</span></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>